#!/bin/bash
# Pre-commit hook: runs fast checks before each commit
# Install with: make install-hooks

set -e

# Ensure GOPATH/bin is in PATH for golangci-lint
export PATH="$PATH:$(go env GOPATH)/bin"

echo "Running pre-commit checks..."

# Format code
echo "  -> Formatting code..."
go fmt ./...

# Run vet
echo "  -> Running go vet..."
go vet ./...

# Run linter
echo "  -> Running golangci-lint..."
if ! command -v golangci-lint &> /dev/null; then
    echo "ERROR: golangci-lint not installed."
    echo "   Run: go install github.com/golangci/golangci-lint/v2/cmd/golangci-lint@latest"
    exit 1
fi
golangci-lint run ./...

echo "Pre-commit checks passed!"
