# Telephone - WebSocket Reverse Proxy Sidecar
# Copy this file to .env and update the values for your environment
#
# All variables marked as REQUIRED must be set. There are no default values.
# Duration values support Go duration syntax: 10s, 5m, 1h, etc.

# ==============================================================================
# PLUGBOARD CONNECTION
# ==============================================================================

# REQUIRED: WebSocket URL for the Plugboard server
# Example: ws://localhost:4000/socket/websocket or wss://plugboard.example.com/socket/websocket
PLUGBOARD_URL=ws://localhost:4000/socket/websocket

# OPTIONAL: Initial JWT token for authentication
# If not provided, Telephone will attempt to load a previously saved token from the database
# TELEPHONE_TOKEN=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# ==============================================================================
# BACKEND SERVICE
# ==============================================================================

# REQUIRED: Backend service hostname or IP address
# This is the service that Telephone proxies requests to
BACKEND_HOST=localhost

# REQUIRED: Backend service port
BACKEND_PORT=8080

# REQUIRED: Backend service scheme (http or https)
BACKEND_SCHEME=http

# ==============================================================================
# TIMEOUTS AND INTERVALS
# ==============================================================================

# REQUIRED: Timeout for establishing WebSocket connections
# Recommended: 10s-30s
CONNECT_TIMEOUT=10s

# REQUIRED: Timeout for backend HTTP requests
# Should be long enough to handle your slowest API endpoints
REQUEST_TIMEOUT=30s

# REQUIRED: Interval for sending heartbeat messages to Plugboard
# Must be less than Plugboard's connection timeout (typically 30s)
# Recommended: 25s-30s
HEARTBEAT_INTERVAL=30s

# REQUIRED: Interval for checking connection health
# Used for detecting stale connections
# Recommended: 5s-10s
CONNECTION_MONITOR_INTERVAL=5s

# ==============================================================================
# RECONNECTION SETTINGS
# ==============================================================================

# REQUIRED: Initial backoff duration for reconnection attempts
# Recommended: 1s-5s
INITIAL_BACKOFF=1s

# REQUIRED: Maximum backoff duration between reconnection attempts
# Backoff increases exponentially with jitter up to this maximum
# Recommended: 30s-60s
MAX_BACKOFF=30s

# REQUIRED: Maximum number of consecutive reconnection attempts before giving up
# Set to -1 for unlimited retries, 0 to disable reconnection
# Recommended: 10-50 or -1 for production
MAX_RETRIES=10

# ==============================================================================
# TOKEN PERSISTENCE
# ==============================================================================

# REQUIRED: Secret key for encrypting tokens at rest
# Must be at least 32 characters. Use a cryptographically secure random string.
# Generate with: openssl rand -base64 64
SECRET_KEY_BASE=your-secret-key-base-at-least-64-characters-long-for-security

# REQUIRED: Path to the SQLite database file for storing tokens
# The directory must exist and be writable
TOKEN_DB_PATH=/var/lib/telephone/tokens.db

# REQUIRED: Timeout for database operations
# Recommended: 5s
DB_TIMEOUT=5s

# ==============================================================================
# PROXY LIMITS
# ==============================================================================

# REQUIRED: Maximum response size in bytes
# Responses larger than this will be rejected
# Example: 104857600 = 100MB
MAX_RESPONSE_SIZE=104857600

# REQUIRED: Chunk size for large responses in bytes
# Large responses are split into chunks of this size
# Example: 1048576 = 1MB
CHUNK_SIZE=1048576

# ==============================================================================
# HEALTH CHECK SERVER
# ==============================================================================

# OPTIONAL: Port for the health check HTTP server
# Set to 0 or omit to disable health checks
# Provides /health, /ready, and /live endpoints for Kubernetes probes
HEALTH_CHECK_PORT=8081

# ==============================================================================
# COMMAND LINE OPTIONS (not environment variables)
# ==============================================================================
#
# The following options are set via command-line flags, not environment variables:
#
# --env        Path to .env file (default: ".env")
# --log-level  Log level: debug, info, warn, error (default: "info")
# --log-format Log format: text, json (default: "text")
#
# Example:
#   ./telephone --log-level=debug --log-format=json
